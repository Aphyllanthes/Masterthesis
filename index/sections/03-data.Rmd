
```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache = TRUE)
options(scipen=999)
```


# Ergebnisse
In den Nisthilfen des Schulinsektenhaus-Projektes welche im Jahr 2019 ausgehängt waren wurden 4716 Bienennester sowie 2147 Wespennester aufgefunden. Somit machen die in dieser Arbeit behandelten Nester etwa 70 % der vorgefundenen Nester aus. Die Wespennester werden in dieser Arbeit nicht behandelt.
Alle weiteren Ergebnisse beziehen sich ausschließlich auf die Biennennester. In Abbildung \ref{deskriptiv} sind die Histogramme der Artenanzahl und Abundanz dargestellt.

```{r message=FALSE, warning=FALSE, include=FALSE, cache=TRUE}
#source("datenschau.R")
load("my_work_space.RData")
```


<!-- Anzahl der Arten pro Nisthilfe | -->
<!-- Anzahl Brutzellen pro Nisthilfe | -->
<!-- | Überlebensrate | Anzahl der lebenden Puppen dividiert durch die Gesamtanzahl der Zellen | -->
<!-- | Parasitierungsrate | Anzahl der parasitierten Zellen dividiert durch die Gesamtanzahl der Zellen | -->

```{r datendeskriptiv, echo=FALSE, fig.cap="Histogramme der Anzahl der Wirts-Bienenarten pro Nisthilfe (links) und Anzahl der von Bienen angelegten Brutzellen (=Abundanz) pro Nisthilfe (rechts) \\label{deskriptiv}"}
p1 <- ggplot(A1, aes(Artenanzahl_det)) + geom_histogram(bins = 8) +
  theme_bw() + labs(x = "Artenzahl der Wirte")
p2 <- ggplot(A1, aes(Abundanz)) + geom_histogram(breaks=c(seq(0, 14, by = 1),seq(15, 100, by = 5), seq(110, 240, by = 10), seq(250, 850, by = 20))) + theme_bw() 

gridExtra::grid.arrange(p1, p2, ncol = 2, heights = unit(4, c("in")))

# sum(nests$nb_cells, na.rm = T) # Anzahl der Zellen gesamt: 18757
# sum(nests$nb_pupa_larva, na.rm = T) # Anzahl Puppen/Larven: 11376
# sum(nests$nb_pupa_larva, na.rm = T) / sum(nests$nb_cells, na.rm = T)
# sum(nests$parasitized_cells, na.rm = T) # Anzahl Parasitierter Zellen
# sum(nests$parasitized_cells, na.rm = T) / sum(nests$nb_cells, na.rm = T)
```


Von den insgesamt `r round(sum(nests$nb_cells, na.rm = T),0)` angelegten Zellen entwickelten sich in etwa 60 % (`r round(sum(nests$nb_pupa_larva, na.rm = T),0)` Brutzellen) Puppen bzw. Larven. Etwa 13 % der Angelegten Zellen wurde Parasitiert (`r sum(nests$parasitized_cells, na.rm = T)` Brutzellen).  

In 45 der 259 Nisthilfen kamen keine Bienen vor. Die häufigsten Wirtsbienenarten waren *Osmia bicornis*, welche 46 % der Nester belegten und *Heriades truncorum*, welche 16 % der Nester belegten. *Osmia cornuta* und *Hylaeus communis* belegten jeweils etwa 8 % der Nester, alle weiteren Arten belegten jeweils weniger als 5 % der Nester.
Der häufigste natürliche Gegenspieler war die Taufliege *Cacoxenus indagator*, welche 17 % aller Nester parasitierte. Arten der Überfamilie der Erzwespen (Chalcidoidea) parasitierten 150 Nester, also 3 % aller Nester, wobei vermutlich die Art *Melittobia acasta* den Großteil davon ausmachte. Die Kuckuckswespe *Sapygina decemguttata* kam mit einer Parasitierungsrate von knapp unter 3 % vor. Alle weiteren natürlichen Gegenspieler kamen je nur in weniger als 100 Nestern und somit in unter 2% aller Nester vor.

## Die Arten in den Nisthilfen
Im Rahmen des Schulinsektenhaus-Projektes konnten in den 259 Nisthilfen insgesammt 27 Wirts-Bienenarten sowie als Parasitoide fünf Kuckucksbienenarten (*Stelis* und *Coelioxys*) und neun parasitische Wespenarten (Apocrita) nachgewiesen werden. Weitere Gegenspieler wie verschiedene Diptera, Käfer (Coleoptera), Milben (*Chaetodacylus*) und Eulophidae kamen vor, wurden jedoch nicht genauer bestimmt. In Tabelle \ref{Artenliste} sind alle nachgewiesenen Arten sowie ihre Gegenspieler aufgeführt. Da einige Parasitoide das gesamte Nest ihres Wirtes eingenommen haben konnten die Wirtsarten nur anhand der Nestmorphologie bestimmt werden - diese sind in der dritten Spalte der Tabelle aufgeführt.

In der Tabelle sind von *Chaetodactylus* befallene Arten nicht dargestellt, da diese nicht einheitlich erfasst wurden, da der Befall zum Großteil durch die Lagerung in der Uni Freiburg stattfand. Identifiziert werden konnten dennoch folgende von *Chaetodactylus* befallene Arten:

  - *Anthidium nanum*
  - *Chelostoma florisomne*, *C. rapunculi* 
  - *Heriades crenulatus*, *H. truncorum* 
  - *Hylaeus communis*, *H. difformis*
  - *Megachile ericetorum*, *M. centuncularis*, *M. rotundata*
  - *Osmia adunca*, *O. bicornis*, *O. caerulescens*, *O. leaiana*

Im Vergleich zu @tscharntke1998 wurden sieben weitere Arten identifiziert: 

  - *Anthidium manicatum*
  - *Hylaeus graciliformis*, *H. hyalinatus*, *H. leptocephalus*, *H. taeniolatus*
  - *Megachile centuncularis*, *M. ligniseca* 
  
Dagegen führen @tscharntke1998 in ihrer Arbeit zwölf Arten auf, die in dieser Arbeit nicht identifiziert wurden:
 
 - *Chelostoma campanularum*, *C. distinctum*
 - *Hylaeus annularis*, *H. gibbus*, *H. punctualissimus*, *H. signatus*
 - *Megachile alpicola*, *M. versicolor*
 - *Osmia claviventris*, *O. gallarum*, *O. leucomelana*, *O. parietina*
 

 
<!-- Welche Parasiten bei tscharntke vorkamen und bei uns nicht: Stelis punctulatissima bei Anthidium nanum, ... -->

 
```{r Artenliste, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
Artliste_IH19 <- readxl::read_excel("../../Daten/Artliste_IH19.xls") %>% 
  replace(is.na(.), "")

kableExtra::kbl(Artliste_IH19,longtable =T,booktabs =T, caption = "Liste aller nachgewiesenen Bienenarten und ihrer natürlichen Gegenspieler im Schulinsektenhausprojekt 2019. Alle Arten die in der Arbeit von Tscharntke et al. (1998) nicht beschrieben wurden bzw. bei den Gegenspielern nicht bei dem entsprechenden Wirt beschrieben wurden, sind mit einem '*' versehen.  \\label{Artenliste} ",
                caption.short = "Liste aller nachgewiesenen Bienenarten und ihrer natürlichen Gegenspieler") %>% 
  kableExtra::kable_paper(full_width = F) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header"), repeat_header_text = "(ref:continued)") %>% 
  kableExtra::column_spec(1, italic = T) %>%
  kableExtra::column_spec(2, width = "15em", italic = T) %>%
  kableExtra::column_spec(3, width = "15em", italic = T)
```



<!-- - chrysura radians an osmia adunca : zetero Galanthea (ohne id) -->

<!-- - ephialtes: @horstmann -->

## Der Einfluss der Landschaftstruktur {#landnutzung}
Zwischen den Parametern der Landschaftstruktur, Kantenlänge und Anzahl der Landnutzungsklassen, und allen Modellierten Antwortvariablen zeigte sich ausschließlich ein Effekt auf die Abundanz. Die Kantenlänge hat dabei einen signifikanten negativen Einfluss und die Anzahl an Landnuzungsklassen einen positiven schwach signifikanten Einfluss auf die Abundanz (siehe Tabelle \ref{summary_Abundanz_a}).

<!-- Zwischen den Sturkturreichtum bescheibenden Parametern Kantendichte und Anzahl der Landnutzungsklassen und der Abundanz der Bienen kann kein Zusammenhang aufgezeigt werden. Ebenso wird kein Zusammenhang der den Strukturreichtum beschreibenden Parametern und der Artenzahl der Bienen beschrieben.  -->


## Der Einfluss von vorhandenen Insektenhäusern auf Artenzahl und Abundanz der Wildbienen
Der Mittelwert der Artenzahl in Nisthilfen, die in der Nähe eines Insektenhauses aufgestellt waren, liegt bei 2,44 Arten, während er in Nisthilfen, in deren Umfeld kein Insektenhaus steht, bei 1,84 Arten liegt. Das Modell, welches den Zusammenhang von vorhandenen Insektenhäusern auf die Artenzahl beschreibt, erklärt $3.1 \%$ der Varianz der Artenzahl. Die Modellzusammenfassung ist in Tabelle \ref{summaryIH} abgebildet, der Effektplot des Modells ist in Abbildung \ref{effektplotIH} links zu sehen. 
Das Ergebnis der Modellierung zeigt einen schwach signifikanten Effekt ($p-Wert =0.03$) der vorhandenen Insektenhäuser auf die Artenzahl in den Nisthilfen auf und bestätigt die Hypothese, dass die Artenzahl in den Nisthilfen in der Nähe eines Insektenhauses höher ist als in Nisthilfen in deren Umfeld kein Insektenhaus vokommt.  

Dieses Modell kann durch die Erweiterung um die Prädiktoren des mittleren Versiegelungsgrades als linearer sowie quadratischer Term nicht verbessert werden. Dies gilt für alle Radien, für den der mittlere Versiegelungsgrad berechnet wurde. Der AIC dieser Modelle im Vergleich zum einfacheren Modell ohne den Versiegelungsgrad als Prädiktor ist jeweils nicht mehr als 2 Einheiten unterschiedlich.    
Umgekehrt verbessert der Parameter "Insektenhaus" das Modell mit den Prädiktoren "Versiegelungsgrad" und "Versiegelungsgrad im Quadrat" ebensowenig.  
<!-- with(summary(modelIH), (null.deviance-deviance)/null.deviance) -->
Aus den beiden erklärenden Variablen, der Information zum vorhandensein eines Insektenhauses in der Nähe des Nisthilfenstandortes und dem Versiegelungsgrad, sticht somit keine Variable hervor, welche die Artenzahl der Wildbienen mit dem Datensatz von 129 Punkten, in besonderem Maße beschreibt.    

Der Mittelwert der Abundanz der Wildbienen in den Nisthilfen liegt bei 89,7 Brutzellen pro Nisthilfe, sofern im Umfeld der Nisthilfe ein Insektenhaus vorhanden war, und bei 66,4 Brutzellen pro Nisthilfe, sofern kein Insektenhotel in der Nähe der Nisthilfe vorhanden war. Die Modellierung der Abundanz anhand der Information von vorhandenen Insektenhäusern zeigt jedoch keinen signifikanten Einfluss ($p-Wert = 0.45$) des Insektenhauses auf die Abundanz auf (siehe Tab. \ref{summaryIH}). Das Modell entählt zusätzlich den mittleren Versiegelungsgrad im 250m-Radius als linearen und quadratischen Term.  
Die Erweiterung des Modells um den Versiegelungsgrad im 250m-Radius der einzige Radius des Versiegelungsgrades (aus den berechneten Radien von 100m, 250m, 500m, 1000m, 2000m), welcher das Modell der vorhandenen Insektenhäusern verbessert. Andersherum kann durch den Parameter "Insektenhaus" kein Modell welches den Einfluss des Versiegelungsgrad der verschiedenen Radien beschreibt verbessert werden. 
Ein Effekt-Plot des um den Parameter des 250m-Versiegelungsgrades erweiterten Modells ist in Abbilung \ref{effektplotIH} auf der rechten Seite dargestellt. Das Modells zeigt einen negativen signifikanten linearen Zusammenhang zwischen dem mittleren Versiegelungsgrad im 250m-Radius und der Abundanz (siehe Tab. \ref{summaryIH}).

Für beide Variablen Artenzahl und Abundanz kann mit dem Datensatz von 129 Punkten nur eine Tendenz eines positiven Einflusses von vorhandenen Insektenhäusern beobachtet werden, wobei dieser Einfluss auf die Artenzahl deutlicher ist als auf die Abundanz. 


(ref:effektIH) Einfluss von vorhandenem Insektenhaus auf Artenanzahl (links) und Abundanz (rechts) der Bienen. Die Fehlerbalken sind 'marginal effect-plots', welche die Vorhersage der Modelle (Mittelwert und Standartabweichung). Der Effektplot der Abundanz beinhaltet den skalierten Versiegelungsgrad des 250m-Radius ("imp 250"). Dargestellt ist der mittlere Versiegelungsgrad von 39.08% (skalierter Wert = 0) und der mittlere Versiegelungsgrad +- Standartabweichung 18,37% (skalierter Wert = -1) und 59,8% (skalierter Wert = 1). Die Punkte stellen die Abundanz der einzelnen Nishilfen dar. \label{effektplotIH}


```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "(ref:effektIH)", fig.scap="Einfluss von vorhandenem Insektenhaus auf Artenanzahl und Abundanz der Wildbienen" }
library(MASS)

sub_IH <- A1_IH_factor %>% 
  filter(!is.na(Insektenhaus)) %>% 
  mutate_at(vars(imp100:DistInsektenhaus), scale) 
## einfluss von Insektenhaus auf artenzahl:
modelIH <- glm.nb(Artenanzahl_det ~ Insektenhaus, data = sub_IH) 

p1ep <- jtools::effect_plot(modelIH, pred = Insektenhaus, interval = TRUE, plot.points = TRUE,
                    jitter = .2) + 
  ylab("Artenzahl der Wirtsbienen") + theme_bw()

## Abundanz:
model_IH2_250_zi <- readRDS("../Modelle/model_IH2_250_zi.rds")

tranlabels <- function(x) attr(sub_IH$imp250, "scaled:center") + attr(sub_IH$imp250, "scaled:scale")*x
werte <- paste(round(tranlabels(c(-1, 0, 1)),2), collapse = ", ")

labeltext <- list("Die Werte des skalierten", 
                         "Versiegelunsgrades -1, 0, 1", 
                  "entsprechen den prozentualen", 
                         paste0("Werten von ", werte))

p2pm <- sjPlot::plot_model(model_IH2_250_zi, type = "pred", 
                   terms = c("Insektenhaus", "imp250"), 
                   show.p = T, show.data = T, jitter = T,
                   title = "")+
  theme_bw() 

gridExtra::grid.arrange(p1ep, p2pm, ncol = 2, heights = unit(4, c("in")),
                        widths = c(3/7, 4/7))

```



```{r echo=FALSE}

detach("package:MASS")
# test <- sjPlot::tab_model(modelIH,  dv.labels = c("Artenzahl"), file = "../../Modelle/modelIH.html", transform = NULL)

tables <- rlist::list.clean(XML::readHTMLTable("../Modelle/modelIH.html"), fun = is.null, recursive = FALSE)
tables2 <- tables[[1]] %>% 
  janitor::row_to_names(row_number = 1) %>% 
  as.matrix() %>% as_tibble()

tables2[is.na(tables2)] <- ""

## Abundanz: 

# test <- sjPlot::tab_model(model_IH2_250_zi,  dv.labels = c("Artenzahl"), file = "../Modelle/model_IH5_zi.html", transform = NULL) 

tables7 <- rlist::list.clean(XML::readHTMLTable("../Modelle/model_IH2_250_zi.html"), fun = is.null, recursive = FALSE)
tables8 <- tables7[[1]] %>% 
  janitor::row_to_names(row_number = 1) %>% 
  as.matrix() %>% as_tibble() %>% 
  mutate(Predictors = janitor::make_clean_names(Predictors) )
  
table_2 <- tables8
table_2[is.na(table_2)] <- ""
table_2$Predictors <- c("count_model", "(Intercept)", "imp250", "imp250^2", "Insektenhaus [1]", "Intercept_2", "zero_inflated_model", "Intercept_3", "Observations")

##
# summary(model_IH2_250_zi) 
```



```{r echo=FALSE, message=FALSE, warning=FALSE}

table_a <- tables2 %>% 
  full_join(table_2, by = "Predictors", suffix = c(".","..")) %>% 
  filter(!Predictors %in% c("zero_inflated_model", "count_model"))
table_a[is.na(table_a)] <- ""
table_a[table_a$Predictors == "Intercept_2",1] <- "count_model: Intercept"
table_a[table_a$Predictors == "Intercept_3",1] <- "zero_inflated_model: Intercept"
table_a <- table_a[-c(3,4),]

kableExtra::kbl(table_a, booktabs =T, caption = "Modellzusammenfassung der Modelle zum Einfluss von vorhandenen Insektenhäusern auf Artenzahl und Abundanz. Die Modelle wurden jeweils unter der Annahme der Negativbinomialverteilung der Antwortvariablen an den reduzierten Datensatz (129 Beobachtungen) aller Nisthilfen mit Information zum vorhandensein eines Insektenhauses gefittet.  \\label{summaryIH} " , caption.short = "Modellzusammenfassung: Einfluss von vorhandenen Insektenhäusern auf Artenzahl und Abundanz" ) %>% #caption = "" 
  kable_styling(latex_options =c("striped")) %>% 
  kableExtra::add_header_above(c(" ","Artenzahl"=3,"Abundanz"=3)) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header", "scale_down"), repeat_header_text = "(ref:continued)") %>% 
  kableExtra::column_spec(4,bold = (as.numeric(table_a$p.)<0.05 | table_a$p. == "<0.001")  & table_a$p. != "" )%>% 
  kableExtra::column_spec(7,bold = (as.numeric(table_a$p..)<0.05 | table_a$p.. == "<0.001") & table_a$p.. != "") 

```



## Der Einfluss des Versiegelungsgrades auf Artenzahl und Abundanz der Bienen
  

<!-- Anhand AIC und Residuendiagnostik wurden für beide Variablen, Artenzahl sowie Abundanz, negativ-binomiale GLM mit folgender Formel ausgewählt: $y = imp1000 + imp1000^2 + Insektenhaus$ (imp1000 ist der mittlere Versiegelungsgrad im 1000m Radius um den Nisthilfenstandort) -->
<!-- Die Datenpunkte sowie die Modellvorhersage als marginaler Effektplot sind in Abbildung \ref{effektplotIH} dargestellt. Das Modell der Artenzahl beschreibt einen signifikanten Einfluss des Parameters Insektenhaus (siehe Tab. \ref{summaryIH}). Im Modell der Abundanz ist eine Tendenz einer Zunahme der Abundanz bei Vorhandensein eines Insektenhauses zu erkennen, welche jedoch nicht signifikant ist. In beiden Modellen hat der Versiegelungsgrad im 1000m Umkreis keinen signifikanten Einfluss. -->
 

<!-- (Null_deviance - Residual_deviance)/Null_deviance -->
Der Versiegelungsgrad aller Radien eignet sich zur Beschreibung der Artenzahl der Wildbienen. Dies zeigte im Vergleich der Modelle  mit verschiedenen Radien des Versiegelungsgrades als beschreibende Variable, da sich die AIC-Werte der Modelle mit jeweils dem besten Fit, um weniger als zwei Einheiten unterschieden. Den niedrigsten AIC weisen das Modell welches den Versiegelungsgrad im 100m-Radius beinhaltet sowie das Modell welches den Versiegelungsgrad im 1000m-Radius beinhaltet auf.
Der Versiegelungsgrad im 100m-Radius hat einen signifikanten linearen Einfluss auf die Artenzahl ($p = 0,003$). Mit zunehmendem Versiegelungsgrad nimmt die Artenzahl ab (siehe Abbildung \ref{plot_modelle_artenzahl} sowie Tabelle \ref{summary_Artenzahl}). Dieser Zusammenhang wird mit p-Werten von $0,01$ und $0,007$ auch durch die Modelle des Versiegelungsgrades im 250m-Radius sowie im 500m-Radius beschrieben. 
Für die Versiegelung in größerer Entfernung um den Nisthilfenstandort, welche vielmehr den generellen Grad der Urbanisierung wiederspiegelt, als die direkte Ressourcenverfügbarkeit für die Bienen, zeigt einen signifikanten quadratischen Einfluss auf die Artenzahl ($p = 0.006$). Bei einem Versiegelungsgrad von ca. $30 \%$ im 1000m-Radius ist die Artenzahl maximal (Abbildung \ref{plot_modelle_artenzahl} rechts) und nimmt bis zur maximalen Versiegelung ab, wo die Artenzahl den niedrigsten Wert aufweist. Dieser Effekt zeigt sich auch durch den Einfluss des Versiegelungsgrad im 2000m-Radius auf die Artenzahl ($p = 0.006$).   
Alle ausgewählten Modelle beinhalten die weiteren Prädiktoren $Jahresniederschlag$ und $Jahresmitteltemperatur$. Der Jahresniederschlag zeigt jeweils einen schwach signifikaten negativen Einfluss auf die Artenzahl, die Jahresmitteltemperatur einen schwach signifikanten positiven Einfluss auf die Artenzahl.


<!-- Zwischen der Artenzahl und dem Versiegelungsgrad besteht kein signifikanter Zusammenhang.   -->
<!-- Zwischen Abundanz und dem mittleren Versiegelungsgrad im 1000m-Radius besteht ein signifikanter quadratischer Zusammenhang. Für den mittleren Versiegelungsgrad geringerer Radien besteht kein Zusammenhang. -->

```{r Artenzahl, message=FALSE, warning=FALSE, include=FALSE}
## selected models::

model1a_step <- readRDS("../Modelle/Artenzahl_100_step.rds")
model2a_step <- readRDS("../Modelle/Artenzahl_250_step.rds")
model3a_step <- readRDS("../Modelle/Artenzahl_500_step.rds")
model4a_step <- readRDS("../Modelle/Artenzahl_1000_step.rds")
model5a_step <- readRDS("../Modelle/Artenzahl_2000_step.rds")

# sjPlot::tab_model(model1a_step, model2a_step, model3a_step, model4a_step, model5a_step,
#                   dv.labels = c("imp100", "imp250", "imp500", "imp1000", "imp2000"),
#                   file = "../Modelle/model_Artenzahl.html", transform = NULL)
## transform html via excel to .csv-file
library(readr)
model_Artenzahl <- read_delim("../Modelle/model_Artenzahl.csv", 
    ";", escape_double = FALSE, col_names = FALSE, 
    trim_ws = TRUE) 
names(model_Artenzahl) <- model_Artenzahl[2,]
model_Artenzahl[is.na(model_Artenzahl)] <- ""
```


(ref:continued) **(Fortsetzung)**


```{r echo=FALSE}

# function for detection of significant values:
p_sig <- function(x){
  x <- unlist(x, recursive = T)
  bold = suppressWarnings((as.numeric(x)<0.05 | x == "<0.001")  & 
                            x != "" &
                            !is.na(x))
  return(bold)
}

kableExtra::kbl(model_Artenzahl[-c(1,2,10),c(1:4,11:13)], booktabs =T, caption = "Modellzusammenfassung der ausgewählten Modelle der Artenzahl der Wildbiene, die den Versiegelungsgrades (imp) der Radien 100m und 1000m beinhalten. \\label{summary_Artenzahl} " ) %>% 
  kable_styling(latex_options =c("striped")) %>% 
  kableExtra::add_header_above(
    c(" ", "imp100"=3,"imp1000"=3)
  ) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header", "scale_down"), repeat_header_text = "(ref:continued)") %>% 
  # kableExtra::column_spec(c(4,7,10, 13,16),
  #                         bold = p_sig(.)) %>% 
  kableExtra::column_spec(4,bold = p_sig(model_Artenzahl[-c(1,2,10),4])) %>% 
  kableExtra::column_spec(7,bold = p_sig(model_Artenzahl[-c(1,2,10),13])) %>% 
  kableExtra::row_spec(7, hline_after = T)

```


```{r echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Der Einfluss des Versiegelungsgrades im 100m-Radius (links) sowie im 1000m-Radius (rechts) auf die Artenzahl der Bienen. Die Punkte stellen die Werte der einzelnen Nisthilfen dar, die Kurve mit blau hinterlegtem Bereich die jeweilige Modellvorhersage mit Standartabweichung. \\label{plot_modelle_artenzahl}"}
unscale <- function(z, center = attr(z, "scaled:center"), scale = attr(z, "scaled:scale")) {
  if(!is.null(scale))  z <- sweep(z, 2, scale, `*`)
  if(!is.null(center)) z <- sweep(z, 2, center, `+`)
  structure(z,
    "scaled:center"   = NULL,
    "scaled:scale"    = NULL,
    "unscaled:center" = center,
    "unscaled:scale"  = scale
  )
}
# model0_step, model2a_step, model3a_step,model4c,model5c,

A1_100 <- A1 %>% 
  dplyr::select(-imp250, -imp500, -imp1000, -imp2000) %>% 
  dplyr::select(-DistInsektenhaus, -Isnsektenhaus)%>% 
  rename(imp = imp100) %>% 
  mutate_at(vars(imp:Forest), scale)%>% 
  dplyr::select(-Urban)

pred_100 <- simulate(model1a_step, nsim = 10000)
pred_100 <- data.frame(pred_mean = rowMeans(pred_100),
                       pred_max = matrixStats::rowQuantiles(as.matrix(pred_100), probs = 0.95),
                       pred_min = matrixStats::rowQuantiles(as.matrix(pred_100), probs = 0.05),
                       imp = unscale(A1_100$imp))


A1_1000 <- A1 %>% 
  dplyr::select(-imp100, -imp250, -imp500, -imp2000) %>% 
  dplyr::select(-DistInsektenhaus, -Isnsektenhaus)%>% 
  rename(imp = imp1000) %>% 
  mutate_at(vars(imp:Forest), scale) %>% 
  dplyr::select(-Urban, -len)

pred_1000 <- simulate(model4a_step, nsim = 10000) # newdata = A1_100, type = "link", se.fit = T 
pred_1000 <- data.frame(pred_mean = rowMeans(pred_1000),
                       pred_max = matrixStats::rowQuantiles(as.matrix(pred_1000), probs = 0.95),
                       pred_min = matrixStats::rowQuantiles(as.matrix(pred_1000), probs = 0.05),
                       imp = unscale(A1_1000$imp))


###
g1 <- ggplot(data = pred_100) + 
  stat_smooth(aes(x = imp, y = pred_min, colour = "min"), method = "loess", se = FALSE, n = 259) +
  stat_smooth(aes(x = imp, y = pred_max, colour = "max"), method = "loess", se = FALSE, n = 259)

# build plot object for rendering 
gg1 <- ggplot_build(g1)

# extract data for the loess lines from the 'data' slot
df2 <- data.frame(imp = gg1$data[[1]]$x,
                  pred_min = gg1$data[[1]]$y,
                  pred_max = gg1$data[[2]]$y) 

###
p1a <- ggplot(data = pred_100) +
  stat_smooth(aes(imp, pred_mean), se = FALSE) +
  geom_ribbon(data = df2, aes(x = imp, ymin = pred_min, ymax  =pred_max), alpha = 0.2, fill = "blue") +
  geom_point(data = A1_100, aes(unscale(imp), Artenanzahl_det), alpha = 0.5) +
  theme_bw()+
  xlab("mittlerer Versiegelungsgrad [%] im 100m-Radius") +
  ylab("Artenzahl der Wildbienen")


###
h1 <- ggplot(data = pred_1000) + 
  stat_smooth(aes(x = imp, y = pred_min, colour = "min"), method = "loess", se = FALSE, n = 259) +
  stat_smooth(aes(x = imp, y = pred_max, colour = "max"), method = "loess", se = FALSE, n = 259)

# build plot object for rendering 
hh1 <- ggplot_build(h1)

# extract data for the loess lines from the 'data' slot
df3 <- data.frame(imp = hh1$data[[1]]$x,
                  pred_min = hh1$data[[1]]$y,
                  pred_max = hh1$data[[2]]$y) 


p2a <- ggplot(data = pred_1000) +
  stat_smooth( aes(imp, pred_mean), n = 259, se = FALSE) +
  geom_ribbon(data = df3, aes(x = imp, ymin = pred_min, ymax  =pred_max), alpha = 0.2, fill = "blue") +
  geom_point(data = A1_1000, aes(unscale(imp), Artenanzahl_det), alpha = 0.5) +
  theme_bw() +
  xlab("mittlerer Versiegelungsgrad [%] im 1000m-Radius") +
  ylab("Artenzahl der Wildbienen")

gridExtra::grid.arrange(p1a, p2a, ncol = 2, heights = unit(3.5, c("in")))



```

Der Einfluss des Versiegelungsgrades auf die Abundanz der Wildbienen in den Nishilfen ist, wie auch der Einfluss auf die Artenzahl, für den Versiegelungsgrad geringer Radien (100m, 250, 500m) linear und für den Versiegelungsgrad großer Radien (500m, 1000m, 2000m) um die Nisthilfen quadratisch. Im Vergleich zur Artenzahl eignen sich zur Beschreibung der Abundanz jedoch nicht alle Radien des Versiegelungsgrades gleichermaßen. Die Modelle des Versiegelungsgrades im 250m-Radius ($AIC = 2573.81$), sowie im 500m-Radius ($AIC = 2575.67$) zeigen den besten fit. Die Modellzusammenfassung der beiden Modelle ist in Tabelle \ref{summary_Abundanz_a} dargestellt.  
Der mittlere Versiegelungsgrad im 250m-Radius hat mit einem p-Wert von $0,00003$ einen hochsignifikanten linearen Einfluss auf die Abundanz (siehe Abbildung \ref{plot_modelle_abundanz}). Das Modell zeigt auch einen signifikanten positiven Effekt der Anzahl an Landnutzungklassen auf, sowie einen signifikanten negativen Effekt der Kantenlänge, welcher bereits in Abschnitt \@ref(landnutzung) dargestellt wurde. Der quadratische Einfluss des Versiegelungsgrades auf die Abundanz, welcher vom Versiegelungsgrad des 500m-Radius beschrieben wird, zeigt das Maximum der Abundanz bei etwa $25\%$ (siehe Abbildung \ref{plot_modelle_abundanz}).


```{r AbundanzA, message=FALSE, warning=FALSE, include=FALSE}

model1b_zi <- readRDS("../Modelle/model1b_zi.rds")
model2a_step_zi <- readRDS("../Modelle/model2a_step_zi.rds")
model3b_zi <- readRDS("../Modelle/model3b_zi.rds")
model4b_zi <- readRDS("../Modelle/model4b_zi.rds")
model5b_zi <- readRDS("../Modelle/model5b_zi.rds")

model_abundanz <- read.csv("../Modelle/model_abundanz.csv") %>% 
  janitor::clean_names()

library(tidyr)
model_abundanz_a <- model_abundanz[,c(1,5,6,7,8,9,10, 17)] %>% 
  #dplyr::arrange(component) %>% 
  dplyr::relocate(component, .after = term) %>% 
   mutate(across(where(is.numeric), round, 3)) %>% 
  mutate_at(vars(contains('value')), 
            funs(case_when(. < 0.001~ "<0.001",
                           . >= 0.001 ~ as.character(.))
            )) %>% 
  replace(is.na(.), "")
names(model_abundanz_a) <- c("term" ,"component", "estimate", "std.error", "p.value", "estimate", "std.error", "p.value")


kableExtra::kbl(model_abundanz_a, booktabs =T, 
                caption = "Modellzusammenfassung der ausgewählten Modelle der Abundanz für die Radien des Versiegelungsgrades 250m und 500m. Die Modelle wurden jeweils unter der Annahme der Negativbinomialverteilung der Antwortvariablen gefittet.  \\label{summary_Abundanz_a} ",
                caption.short="Modellzusammenfassung zur Abundanz der Wildbienen, 250m und 500m") %>% 
  #kable_styling(latex_options =c("striped", "hold_position")) %>% 
  kableExtra::add_header_above(
    c(" " = 2, "imp250"=3,"imp500"=3)
  ) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header", "scale_down", "striped"), repeat_header_text = "(ref:continued)") %>% 
  # kableExtra::column_spec(c(4,7,10, 13,16),
  #                         bold = p_sig(.)) %>% 
  kableExtra::column_spec(5,bold = p_sig(model_abundanz_a[,5])) %>% 
  kableExtra::column_spec(8,bold = p_sig(model_abundanz_a[,8]))

```





```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Die Modelle des mittleren Versiegelungsgrades im 250m-Radius (links) sowie 2000m-Radius (rechts), welche den Einfluss der Nullen (Zeroinflation) brücksichtigen. Die Linie beschreibt den Mittelwert der mittels der R-Funktion simulate() simulierten Daten, der violett gezeichnete Bereich beschreibt Bereich bis zum 95 \\% Quantil der Simulierten Daten, die Punkte sind die realen Messwerte. \\label{plot_modelle_abundanz}"}


A1_250 <- A1 %>% 
  dplyr::select(-imp100, -imp500, -imp1000, -imp2000) %>% 
  dplyr::select(-DistInsektenhaus, -Isnsektenhaus)%>% 
  rename(imp = imp250) %>% #filter(Abundanz < 500) %>% 
  mutate_at(vars(imp:Forest), scale) %>% 
  dplyr::select(-Urban)

pred_250 <- simulate(model2a_step_zi, nsim = 10000) # newdata = A1_100, type = "link", se.fit = T 
pred_250 <- data.frame(pred_mean = rowMeans(pred_250),
                       pred_max = matrixStats::rowQuantiles(as.matrix(pred_250), probs = 0.95),
                       pred_min = matrixStats::rowQuantiles(as.matrix(pred_250), probs = 0.05),
                       imp = unscale(A1_250$imp))

###
g1 <- ggplot(data = pred_250) + 
  stat_smooth(aes(x = imp, y = pred_min, colour = "min"), method = "loess", se = FALSE, n = 259) +
  stat_smooth(aes(x = imp, y = pred_max, colour = "max"), method = "loess", se = FALSE, n = 259)

# build plot object for rendering 
gg1 <- ggplot_build(g1)

# extract data for the loess lines from the 'data' slot
df2 <- data.frame(imp = gg1$data[[1]]$x,
                  pred_min = gg1$data[[1]]$y,
                  pred_max = gg1$data[[2]]$y) 

###
p1a <- ggplot(data = pred_250) +
  stat_smooth(aes(imp, pred_mean), se = FALSE) +
  geom_ribbon(data = df2, aes(x = imp, ymin = pred_min, ymax  =pred_max), alpha = 0.2, fill = "blue") +
  geom_point(data = A1_250, aes(unscale(imp), Abundanz), alpha = 0.5) +
  theme_bw()+
  xlab("mittlerer Versiegelungsgrad [%] im 250m-Radius") +
  ylab("Abundanz (Anzahl der Brutzellen)")



#
A1_500 <- A1 %>% 
  dplyr::select(-imp100, -imp250, -imp1000, -imp2000) %>% 
  dplyr::select(-DistInsektenhaus, -Isnsektenhaus)%>% 
  rename(imp = imp500)  %>%# filter(Abundanz < 500) %>% 
  mutate_at(vars(imp:Forest), scale) %>% 
  dplyr::select(-Urban)

pred_500 <- simulate(model3b_zi, nsim = 10000) # newdata = A1_100, type = "link", se.fit = T 
pred_500 <- data.frame(pred_mean = rowMeans(pred_500),
                       pred_max = matrixStats::rowQuantiles(as.matrix(pred_500), probs = 0.95),
                       pred_min = matrixStats::rowQuantiles(as.matrix(pred_500), probs = 0.05),
                       imp = unscale(A1_500$imp))


###
h1 <- ggplot(data = pred_500) + 
  stat_smooth(aes(x = imp, y = pred_min, colour = "min"), method = "loess", se = FALSE, n = 259) +
  stat_smooth(aes(x = imp, y = pred_max, colour = "max"), method = "loess", se = FALSE, n = 259)

# build plot object for rendering 
hh1 <- ggplot_build(h1)

# extract data for the loess lines from the 'data' slot
df3 <- data.frame(imp = hh1$data[[1]]$x,
                  pred_min = hh1$data[[1]]$y,
                  pred_max = hh1$data[[2]]$y) 


p2a <- ggplot(data = pred_500) +
  stat_smooth( aes(imp, pred_mean), n = 259, se = FALSE) +
  geom_ribbon(data = df3, aes(x = imp, ymin = pred_min, ymax  =pred_max), alpha = 0.2, fill = "blue") +
  geom_point(data = A1_500, aes(unscale(imp), Abundanz), alpha = 0.5) +
  theme_bw() +
  xlab("mittlerer Versiegelungsgrad [%] im 500m-Radius") +
  ylab("Abundanz (anzahl Brutzellen)")

gridExtra::grid.arrange(p1a, p2a, ncol = 2, heights = unit(3.5, c("in")))


```



## Artenzahl der natürlichen Gegenspieler
Der Einfluss der Artenzahl der Wirte auf die Artenzahl der natürlichen Gegenspieler ist hochsignifikant ($p<2e-16$). Ein zusätzlicher Einfluss von Versiegelungsgrad und vorhandenen Insektenhäusern am Nisthilfenstandort auf die Artenzahl der natürlichen Gegenspieler kann in dieser Arbeit nicht aufgezeigt werden.   Die Modellannahmen der Modelle, welche den Einfluss des Versiegelungsgrades auf die Artenzahl der natürlichen Gegenspieler beschreiben, sind durch die Devianz der Quantile verletzt. 

<!-- kann es sein dass durch das Rauschen der Daten von Versiegelungsgrad und Insektehaus viel größer ist als das der Artenzahl der wirtsbienen und daher alle Modelle quantile deviations aufzeigen? -->



## Die Abundanz von Osmia bicornis
Die Rostrote Mauerbiene (*Osmia bicornis*) kam in 148 der 259 Nisthilfen vor. Im Mittel befanden sich 84 Nester in einer Nisthilfe, der Median lag bei 2 belegten Nestern pro Nisthilfe. Die Maximale Anzahl an Nestern in einer Nisthilfe betrug 115 Nester.

Das Vorhandensein eines Insektenhauses in der Nähe der Nisthilfe hat keinen signifikanten Einfluss auf die Abundanz von *Osmia bicornis* (siehe Tabelle \ref{summary_Abundanz_IH_ob}). Der mittlere Versiegelungrad im 250m Radius um den Nisthilfenstandort verbessert das Modell welches den Einfluss des Insektenhauses auf die Abundanz von *O. bicornis* beschreibt. Der mittlere Versiegelungsgrad anderer Radien verbessert das Modell nicht. Der Parameter Insektenhaus kann keines der Modelle mit den Prädiktoren des Versiegelungsgrades der verschiedenen Radien verbessern.  


```{r OBIH, message=FALSE, warning=FALSE, include=FALSE}
model_IH_ob <- read_delim("../Modelle/model_IH_Ob_lat.csv", 
    ";", escape_double = FALSE, col_names = FALSE, 
    trim_ws = TRUE) 
names(model_IH_ob) <- model_IH_ob[2,]
model_IH_ob[is.na(model_IH_ob)] <- ""

kableExtra::kbl(model_IH_ob[-c(1,2),1:4], booktabs =T, caption = "Modellzusammenfassung des ausgewählten Modelles des Einflusses von vorhandenen Insektenhäusern auf die Abundanz von Osmia bicornis. Das Modell wurde unter der Annahme der Negativbinomialverteilung gefittet.  \\label{summary_Abundanz_IH_ob} ",
                caption.short = "Modellzusammenfassung: Einfluss von Insektenhäusern auf Abundanz von Osmia bicornis") %>% 

  kableExtra::kable_styling(latex_options =c("repeat_header", "striped"), repeat_header_text = "(ref:continued)") %>% 
  # kableExtra::column_spec(c(4,7,10, 13,16),
  #                         bold = p_sig(.)) %>% 
  kableExtra::column_spec(4,bold = p_sig(model_IH_ob[-c(1,2),4])) %>% 
  #kableExtra::column_spec(7,bold = p_sig(model_IH_ob[-c(1,2),7])) %>% 
  kableExtra::row_spec(5, hline_after = T)
```


```{r modelOb1, message=FALSE, warning=FALSE, include=FALSE}
Ob_models_list <- readRDS(file = "../Modelle/Ob_models_list.rds")

# test <- sjPlot::tab_model(Ob_models_list[[1]], Ob_models_list[[2]], Ob_models_list[[3]],
#                   Ob_models_list[[4]], Ob_models_list[[5]],
#                   dv.labels = c("imp100", "imp250", "imp500", "imp1000", "imp2000"),
#                   file = "../Modelle/model_Ob.html",
#                   transform = NULL)

library(readr)
model_ob1 <- read_delim("../Modelle/model_Ob.csv", 
    ";", escape_double = FALSE, col_names = FALSE, 
    trim_ws = TRUE) 

names(model_ob1) <- model_ob1[2,]
model_ob1[is.na(model_ob1)] <- ""

kableExtra::kbl(model_ob1[-c(1,2),], booktabs =T, caption = "Modellzusammenfassung der ausgewählten Modelle von Osmia bicornis. Die Modelle wurden jeweils unter der Annahme der Negativbinomialverteilung gefittet.  \\label{summary_Abundanz_ob} ",
                caption.short = "Modellzusammenfassung: Einfluss von Versiegelungsgrad auf Abundanz von Osmia bicornis") %>% 
  kableExtra::add_header_above(
    c(" ", "imp100"=3,"imp250"=3,"imp500"=3, "imp1000"=3, "imp2000"=3) 
  ) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header", "scale_down", "striped"), repeat_header_text = "(ref:continued)") %>% 
  # kableExtra::column_spec(c(4,7,10, 13,16),
  #                         bold = p_sig(.)) %>% 
  kableExtra::column_spec(4,bold = p_sig(model_ob1[-c(1,2),4])) %>% 
  kableExtra::column_spec(7,bold = p_sig(model_ob1[-c(1,2),7])) %>% 
  kableExtra::column_spec(10,bold = p_sig(model_ob1[-c(1,2),10])) %>% 
  kableExtra::column_spec(13,bold = p_sig(model_ob1[-c(1,2),13])) %>% 
  kableExtra::column_spec(16,bold = p_sig(model_ob1[-c(1,2),16])) %>% 
  kableExtra::row_spec(7, hline_after = T)

```

Die Abundanz von *Osmia bicornis* ist bei einem Versiegelungsgrad von 35 % maximal und nimmt innerhalb Deutschlands von Norden nach Süden ab. Abbildung \ref{effektplotOb} zeigt diesen Effekt anhand der Modellierung der Abundanz mit dem Versiegelungsgrad im 500m-Radius und dem Breitengrad. Dieses Modell zeigt mit einem AIC von $1403.6$ im Vergleich zu den Modellen mit dem Versiegelungsgrad anderer Radien den besten Fit. Neben diesem Modell eignet sich auch das Modell, welches den Versiegelungsgrad im 250m-Radius beinhaltet ($AIC = 1404.7$) zur Beschreibung der Abundanz von *Osmia bicornis* (siehe Tab. \ref{summary_Abundanz_ob}). In dem Modell zeigt zusätzlich der Anteil an Ackerland einen negativen signifikanten Einfluss auf die Abundanz der Mauerbienenart und der Längengrad einen signifikanten positiven Einfluss.

(ref:obEffects) Einfluss vom mittleren Versiegelungsgrad im 500m-Radius auf die Abundanz (Anzahl angelegter Nester)  von *Osmia bicornis*. Mittelwert und Standartabweichung der Modellvorhersage sind durch die Kurven und den farbig hinterlegten Bereichen dargestellt. Die Farben stellen den Längengrad dar. Die skalierten Werte des Breitengrades -1, 0 und 1 sind das 1. Quantil, Median und 3. Quantil des Datensatzes.  Der Wert -1 entspricht dem Breitengrad bei Stuttgart, der Wert 0 entspricht dem Breitengrad bei Fulda und der Wert -1 dem Breitengrad bei Hildesheim. Die Punkte stellen die Abundanz von Osmia bicornis pro Nisthilfe dar. \label{effektplotOb}


(ref:obEffectsSCAP) Abundanz von *Osmia bicornis*: Einfluss des Versiegelungsgrades.


```{r plotObModels, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "(ref:obEffects)" , fig.scap="(ref:obEffectsSCAP)" }
#Ob_250
#Ob_models_list[[2]]
Ob_250 <- readRDS("data/Ob_250.rds")
tranlabels <- function(x = Ob_250$imp) attr(Ob_250$imp, "scaled:center") + attr(Ob_250$imp, "scaled:scale")*x

tranlat <- function(x = Ob_250$lat) attr(Ob_250$lat, "scaled:center") + attr(Ob_250$lat, "scaled:scale")*x

#tranlat(c(-1, 0, 1))
ticks_x <- scale(c(0, 10, 20, 30, 40, 50, 60, 70, 80), 
      center =  attr(Ob_250$imp, "scaled:center"),
      scale = attr(Ob_250$imp, "scaled:scale"))

sjPlot::plot_model(Ob_models_list[[3]], type = "pred", 
                   terms = c( "imp","lat"),
                   show.p = T, show.data = T, jitter = T,
                   title = "",
                   legend.title = "Breitengrad, skaliert")+
  scale_x_continuous(breaks = ticks_x , 
                     labels = as.numeric(tranlabels(ticks_x))) +
  theme_bw() +
  xlab("mittlerer Versiegelungsgrad im 500m-Radius") +
  ylab(expression(paste("Abundanz von ", italic("Osmia bicornis"))))

# -1 = stuttgart, 0 = fulda, 1 = hildesheim
```


## Artengemeinschaft
Die Analyse der Artengemeinschaft entlang des Stadt-Land-Gradienten zeigte, dass weder Strukturparameter noch Versiegelungsgrad verschiedener Radien einen signifikanten Einfluss auf die Zusammensetzung der Arten in den Trapnestern hat. Auch der Vergleich der Artenzusammensetzung der Nisthilfen-Gruppen "Land", "Stadtrand" und "Stadt" zeigte keinen signifikanten Unterschied.  
Die Artengemeinschaft von Standorten, bei denen im 500m-Radius Ackerland vorkommt unterscheidet sich nicht von der Artengemeinschaft, bei der im 500m-Radius kein Ackerland vorkomt.  
Durch die Betrachtung des Versiegelungsgrades der Standorte der einzelnen Arten können Unterschiede aufgezeigt werden.

(ref:lonelytab) Auflistung der Arten, welche nur in einer Nisthilfe vorkamen, mit der Information wiviele Nester in der Nisthilfe belegt waren ('Nests') und dem mittleren Versiegelungsgrad in % im 500m-Radius der besiedelten Nisthilfe. \label{lonely_species} 


```{r echo=FALSE, message=FALSE, warning=FALSE}
# Arten die nur in einem Nest vorkamen:
lonely_species <- read.csv("../summaryTabellen/lonely_species_summary.csv") %>% 
  mutate(imp500 = round(imp500,2)) %>% 
  mutate(Art.x = stringr::str_to_sentence(Art.x)) %>% 
  rename(Art = Art.x)

lonely_species %>%
  kable(booktabs = T, linesep = "",  caption = "(ref:lonelytab)",
        caption.short = "Auflistung der Arten, welche nur in einer Nisthilfe vorkamen") %>%
  kable_paper(full_width = F) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header"), repeat_header_text = "(ref:continued)") %>% 
  column_spec(3, color = "white",
              background =spec_color(lonely_species$imp500)) %>% 
  column_spec(1, italic = T)


```


Es kamen elf Arten in nur einer Nisthilfe vor. Die Arten sind in Tabelle \ref{lonely_species} inklusive dem Versiegelungsgrad im 500m-Radius der Nisthilfe aufgeführt. Neun der elf Arten kamen in relativ gering versiegeltem Umfeld vor (Versiegelungsgrad im 500m-Radius < 25%).   
In Tabelle \ref{multiple_species} sind alle Arten aufgeführt, die in mehr als einer Nisthilfe vorkamen, sowie die Info in welcher Kategorie des Versiegelungsgrades die Nisthilfe vorkam. Dabei fällt auf, das die beiden Arten der parasitischen Gattung *Gasteruption* besonders häufig im Urbanen Gebiet mit hohem Versiegelungsgrad vorkamen. Die Gartenwollbiene, *Anthidium manicatum* kam in nur 2 Nisthilfen vor, davon keine aus der Kategorie "Land" mit geringem Versiegelungsgrad. Alle anderen Arten kamen auch in Nisthilfen der Kategorie "Land" vor. Dagegen kamen sieben Arten nicht in Nisthilfen der Kategorie "Stadt", mit hohem Versiegelungsgrad vor. Darunter die Gegenspieler *Chrysis radians*, *Sapyga clavicornis* und *Sapyga quinquepunctata*.



(ref:landspec) Auflistung der Arten, welche in mehr als einer Nisthilfe vorkamen. Die Nisthilfen wurden Anhand der 33% und 66%-Quantile des Versiegelungsgrades im 500m-Radius in die Kategorien 'Land' (<33%), 'Stadtrand' (>33% und <66%) und 'Stadt'(>66%)  unterteilt. In der Tabelle ist die Anzahl an besidelten Nisthilfen der jeweiligen Kategorie dargestellt und nach dem Antei der Nisthilfen in der Kategorie Stadt angeordnet. In der Spalte "mittl. Versiegelungsgrad" steht der Mittelwert des mittleren Versiegelungsgrad im 500m Radius um die Nisthilfen  aller Nisthilfen, in denen die jeweilige Art vorkam. \label{multiple_species}


```{r echo=FALSE, message=FALSE, warning=FALSE}
# Arten nd wo sie vorkamen:
land_species <- read.csv("../summaryTabellen/Arten_Stad_Land.csv")
land_species <- land_species %>% 
  arrange(Anteil_stadt) %>% 
  mutate(meanImp = round(meanImp, 2))

names(land_species) <- c("Art", "Land", "Stadtrand", "Stadt", "mittl. Versiegelungsgrad", "Anteil_Stadt")

land_species[,1:5] %>% 
  kable(booktabs = T, linesep = "", longtable =T, 
        caption = "(ref:landspec)",
        caption.short = "Auflistung der Arten, welche in mehr als einer Nisthilfe vorkamen." ) %>% #
  kable_paper(full_width = F) %>%
  kableExtra::kable_styling(latex_options =c("repeat_header", "scale_down"), repeat_header_text = "(ref:continued)") %>% 
  column_spec(5, color = "white",
              background =spec_color(land_species$`mittl. Versiegelungsgrad`))



```



<!-- -envfit Versiegelungsgrad und Strukturreichtum -->
<!-- - Adonis zwei Gruppen 50 versiegeltste STandorte und 50 unversiegelste Standorte (ländlich) -->


<!-- ## Thema -->

<!-- Detecting landscape patterns that impact the wild bee diversity and promote the potential occurance of different wild bee species. Landscape patterns like landuse type, imperviousness and water bodies may act as proxi-variables for the available nesting- and food-resources that directly affect the occurance of different wild bee species. -->

<!--  In the changing environment, wild bees adapt to new habitats. The knowledge about wild bees species hotspots, especially in urban areas, is important to design appropriate measures to promote diversity.  -->

## Netzwerkanalyse
Die Netzwerkanalyse der Kategorie "Land", welche 107 Nisthilfenstandorte beinhaltet und der Kategorie "Stadt" welche 110 Nisthilfenstandorte beinhaltest, ergibt für beide Kategorieen mit dem Index H2 einen mittleren Spezialisierungsgrad von $0.60$ bzw. $0.61$. Alle Werte der Generalisierung der natürlichen Gegenspieler als auch der Vulnerabilität der Wirtsbienenarten beider Gruppen liegen zwischen $2.0$ und $2.5$. Somit sind keine deutlichen Unterschiede der Wirt-Parasit-Beziehungen zwischen ländlichen Nisthilfenstandorten und urbanen Nisthilfenstandorten zu erkennen. In Abbildung \ref{networkland} ist das Interaktionsnetzwerk der Nisthilfen der Kategorie "Land" dargestellt, in Abbildung \ref{networkstadt} ist das Interaktionsnetzwerk der Nisthilfen der Kategorie "Stadt" dargestellt. Die Netzwerkdarstellung der Kategorie "Land" wirkt komplexer als die Netzwerkdarstellung der Kategorie "Stadt". Dies bedeutet jedoch nicht, dass sich der Spezialisierungsgrad unterscheidet, sondern lediglich, dass es insgesamt mehr Arten und somit auch mehr Interaktionen gibt.


```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Das bipartite Interaktionsnetzwerk der Nisthilfen der Kategorie Land. Die Kategorie beinhaltet alle Nisthilfen mit einem mittleren Versiegelungsgrad im 500m-Radius von weniger als 24\\% versiegelter Fläche. Die oberen Balken stellen die natürlichen Gegenspieler dar, die unteren Balken deren Wirte. Die Interaktionen sind durch die verbindung der oberen und unteren Balken dargestellt. Die Balkendicke stellt die Häufigkeit der Interaktionen dar, wobei diese pro Nest gezählt wurden.  \\label{networkland}", fig.scap="Netzwerkdarstellung der Nisthilfen der Kategorie Land" }

Praedi_groups <- Praedis %>% 
  #filter(Praedis$ID %in% Artenzahl$location) %>% 
  mutate(
    group = ifelse(
      imp500 > quantile(Praedis$imp500, probs = 0.66),
      "stadt",
      ifelse(
        imp500 <= quantile(Praedis$imp500, probs = 0.33),
        "land",
        "medium"
      )
    )
  ) %>% 
  mutate(group = as.factor(group)) %>% 
  mutate(Ackerland = as.factor(case_when(Arable > 0  ~ "arable",
                                         Arable == 0 ~ "non_arable")))

library(bipartite) 

#table(Praedi_groups[,c("group")])
nw <- Artenzahl %>% 
  dplyr::select(id, location, species_type, Art) %>% 
  group_by(species_type, id) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(names_from = species_type, values_from = Art) %>%
  dplyr::select(-row) %>% 
  left_join(dplyr::select(Praedi_groups, ID, group, Ackerland), by = c("location"= "ID")) %>% 
  filter(!is.na(Parasitoid)) %>% 
  filter(!is.na(Host))
  
nw_frame <-  frame2webs(nw, varnames = c("Host", "Parasitoid", "group"))

plotweb(nw_frame[[1]])


# visweb(nw_frame[[1]])
# visweb(nw_frame[[3]])

# round(networklevel(nw_frame[[1]], index = c("generality", "H2", "links per species", "nestedness", "connectance" )),2)
# round(networklevel(nw_frame[[3]], index = c("generality", "H2", "links per species", "nestedness", "connectance" )),2)
```



```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Das bipartite Interaktionsnetzwerk der Nisthilfen der Kategorie Stadt. Die Kategorie beinhaltet alle Nisthilfen mit einem mittleren Versiegelungsgrad im 500m-Radius von weniger als 44\\% versiegelter Fläche. Die oberen Balken stellen die natürlichen Gegenspieler dar, die unteren Balken deren Wirte. Die Interaktionen sind durch die Verbindung der oberen und unteren Balken dargestellt. Die Balkendicke stellt die Häufigkeit der Interaktionen dar, wobei diese pro Nest gezählt wurden. \\label{networkstadt}", fig.scap="Netzwerkdarstellung der Nisthilfen der Kategorie Stadt"}
plotweb(nw_frame[[3]])
```


<!-- invasive arten? -->

